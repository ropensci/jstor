<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysing n-grams with <code>jstor</code> for R • jstor</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Analysing n-grams with &lt;code&gt;jstor&lt;/code&gt; for R">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jstor</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/automating_file_import.html">Automating File Import</a>
    </li>
    <li>
      <a href="../articles/known-quirks.html">Known Data Quirks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/analysing-n-grams.html">Case Study - Analysing Ngrams</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tklebel/jstor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analysing n-grams with <code>jstor</code> for R</h1>
                        <h4 class="author">Thomas Klebel</h4>
            
            <h4 class="date">2018-07-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/jstor/blob/master/vignettes/analysing-n-grams.Rmd"><code>vignettes/analysing-n-grams.Rmd</code></a></small>
      <div class="hidden name"><code>analysing-n-grams.Rmd</code></div>

    </div>

    
    
<p>The service <a href="http://www.jstor.org/dfr/">DfR</a> by JSTOR offers several ways for text analysis of scientific articles. In this vignette I will demonstrate how to analyse n-grams which DfR delivers.</p>
<p>Let’s suppose, we are interested in the topic of “inequality” within the discipline of sociology. Social inequality can be considered a prime subject of sociological inquiry. In order to gain some context on the subject, we might be interested to analyse frequently occurring terms. DfR offers different grades of tokenization: n-grams for 1-3 words, e.g. unigrams, bigrams and trigrams. In case you are unfamiliar with the analysis of tokenized text, you could read the first few paragraphs of chapters 1 and 4 in <a href="https://www.tidytextmining.com" class="uri">https://www.tidytextmining.com</a> as an introduction.</p>
<p>Our analysis starts at the main page of <a href="http://www.jstor.org/dfr/">DfR</a>. We create a dataset<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> by searching for “inequality” and selecting “sociology” as our subject. To trim down the number of articles, we only select articles from 1997 to 2017. After logging in/creating an account, we select unigrams and bigrams. The resulting <code>.zip</code>-file can be downloaded from the email which DfR sends.</p>
<p>Up-front, we need to load some packages. <code>jstor</code> is currently not available from CRAN, but can be installed via <code>devtools</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># devtools::install_github("tklebel/jstor")</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(jstor)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(future)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co"># set a lighter theme for plots</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co"># import files in parallel</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw"><a href="http://www.rdocumentation.org/packages/future/topics/plan">plan</a></span>(multiprocess)</a></code></pre></div>
<p>With the latest version of <code>jstor</code> we can now directly import files from a zip archive. We only need to specify, where the zip archive is located, which parts we want to extract, and where the resulting files should be saved.</p>
<p>Before importing data, we can take a quick look at the contents of each archive with <code><a href="../reference/jst_preview_zip.html">jst_preview_zip()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/jst_preview_zip.html">jst_preview_zip</a></span>(<span class="st">"part1.zip"</span>)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   type     meta_type           n
##   &lt;chr&gt;    &lt;chr&gt;           &lt;int&gt;
## 1 metadata journal_article 19782
## 2 ngram1   ngram1          19759
## 3 ngram2   ngram2          19739
## 4 ngram3   ngram3          19727</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/jst_preview_zip.html">jst_preview_zip</a></span>(<span class="st">"part2.zip"</span>)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   type     meta_type           n
##   &lt;chr&gt;    &lt;chr&gt;           &lt;int&gt;
## 1 metadata journal_article  4127
## 2 ngram1   ngram1           4151
## 3 ngram2   ngram2           4172
## 4 ngram3   ngram3           4184</code></pre>
<p>Although we could import all ngrams at this point, this would be extremely inefficient. It is thus best first to decide, which articles we want to analyze, and import the corresponding ngram-files afterwards.</p>
<p>The following code assumes that you follow a workflow organised around projects within RStudio (refer to <a href="http://r4ds.had.co.nz/workflow-projects.html" class="uri">http://r4ds.had.co.nz/workflow-projects.html</a> for further information).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">import_spec &lt;-<span class="st"> </span><span class="kw"><a href="../reference/jst_define_import.html">jst_define_import</a></span>(<span class="dt">article =</span> jst_get_article)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="../reference/jst_import.html">jst_import_zip</a></span>(<span class="st">"part1.zip"</span>, <span class="dt">import_spec =</span> import_spec, <span class="dt">out_file =</span> <span class="st">"part1"</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw"><a href="../reference/jst_import.html">jst_import_zip</a></span>(<span class="st">"part2.zip"</span>, <span class="dt">import_spec =</span> import_spec, <span class="dt">out_file =</span> <span class="st">"part2"</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; Processing files for journal_article with functions jst_get_article</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; Processing chunk 1/1</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;  Progress: ───────────────────────────────────────────────────────────── 100%</span></a></code></pre></div>
<p>Since <code>jst_import_zip</code> writes the results to disk, we need to read the metadata from the newly created file. This is made easy by <code>jst_re_import</code> which ensures, that the data are read with the right column types.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">imported_metadata &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"part1_journal_article_jst_get_article-1.csv"</span>,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                       <span class="st">"part2_journal_article_jst_get_article-1.csv"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw">map_df</span>(jst_re_import)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">imported_metadata</a></code></pre></div>
<pre><code>## # A tibble: 23,909 x 19
##    file_name     journal_doi journal_jcode journal_pub_id journal_title   
##    &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;           
##  1 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
##  2 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
##  3 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
##  4 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
##  5 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
##  6 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
##  7 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
##  8 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
##  9 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
## 10 journal-arti… &lt;NA&gt;        &lt;NA&gt;          amerjsoci      American Journa…
## # ... with 23,899 more rows, and 14 more variables: article_doi &lt;chr&gt;,
## #   article_pub_id &lt;chr&gt;, article_jcode &lt;chr&gt;, article_type &lt;chr&gt;,
## #   article_title &lt;chr&gt;, volume &lt;chr&gt;, issue &lt;chr&gt;, language &lt;chr&gt;,
## #   pub_day &lt;chr&gt;, pub_month &lt;chr&gt;, pub_year &lt;int&gt;, first_page &lt;chr&gt;,
## #   last_page &lt;chr&gt;, page_range &lt;chr&gt;</code></pre>
<div id="cleaning-the-data" class="section level1">
<h1 class="hasAnchor">
<a href="#cleaning-the-data" class="anchor"></a>Cleaning the data</h1>
<p>Data from DfR is inherently messy. To fix a few common issues, we can use <code><a href="../reference/jst_augment.html">jst_augment()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">imported_metadata &lt;-<span class="st"> </span><span class="kw"><a href="../reference/jst_augment.html">jst_augment</a></span>(imported_metadata, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>For more information on common quirks with data from DfR and how to deal with them, take a look at the <code><a href="../articles/known-quirks.html">vignette("known-quirks")</a></code>.</p>
</div>
<div id="exploration" class="section level1">
<h1 class="hasAnchor">
<a href="#exploration" class="anchor"></a>Exploration</h1>
<p>Before diving into the analysis of n-grams, we might wish to take an explorative look at our metadata. The first thing to look at are the types of articles.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">ggplot</span>(imported_metadata, <span class="kw">aes</span>(article_type)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<p><img src="analysing-n-grams_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>We can see, that the majority of articles are proper “research-articles”, which together with book-reviews and miscellaneous articles amount to ~99% of all articles.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">imported_metadata <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(article_type, <span class="dt">sort =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perc =</span> scales<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/scales/topics/percent_format">percent</a></span>(n<span class="op">/</span><span class="kw">sum</span>(n)))</a></code></pre></div>
<pre><code>## # A tibble: 14 x 3
##    article_type         n perc 
##    &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;
##  1 research-article 16289 68.1%
##  2 book-review       4552 19.0%
##  3 misc              2850 11.9%
##  4 other               89 0.4% 
##  5 in-brief            38 0.2% 
##  6 discussion          31 0.1% 
##  7 review-article      25 0.1% 
##  8 announcement        12 0.1% 
##  9 index                9 0.0% 
## 10 editorial            7 0.0% 
## 11 introduction         3 0.0% 
## 12 news                 2 0.0% 
## 13 bibliography         1 0.0% 
## 14 letter               1 0.0%</code></pre>
<p>We must be cautious, however, when using this variable to distinguish articles into categories. In this instance, we have “research-articles” which are actually book-reviews:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">imported_metadata <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(article_type <span class="op">==</span><span class="st"> "research-article"</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">str_detect</span>(article_title, <span class="st">"Book"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(file_name, article_title, pub_year)</a></code></pre></div>
<pre><code>## # A tibble: 190 x 3
##    file_name                      article_title pub_year
##    &lt;chr&gt;                          &lt;chr&gt;            &lt;int&gt;
##  1 journal-article-10.1086_210272 Book Reviews      1999
##  2 journal-article-10.1086_210273 Book Reviews      1999
##  3 journal-article-10.1086_210274 Book Reviews      1999
##  4 journal-article-10.1086_210275 Book Reviews      1999
##  5 journal-article-10.1086_210276 Book Reviews      1999
##  6 journal-article-10.1086_210278 Book Reviews      1999
##  7 journal-article-10.1086_210279 Book Reviews      1999
##  8 journal-article-10.1086_210280 Book Reviews      1999
##  9 journal-article-10.1086_210281 Book Reviews      1999
## 10 journal-article-10.1086_210283 Book Reviews      1999
## # ... with 180 more rows</code></pre>
<p>For the current demonstration, we want to restrict the type of articles to research articles, therefore we need to take steps to remove book reviews and other miscellaneous articles: First, filter by <code>article_type</code>, then remove articles where the title starts with “Book Review”.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">research_articles &lt;-<span class="st"> </span>imported_metadata <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(article_type <span class="op">==</span><span class="st"> "research-article"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">str_detect</span>(article_title, <span class="st">"^Book Review"</span>))</a></code></pre></div>
<div id="the-moving-wall---filtering-articles-by-time" class="section level2">
<h2 class="hasAnchor">
<a href="#the-moving-wall---filtering-articles-by-time" class="anchor"></a>The moving wall - filtering articles by time</h2>
<p>Since JSTOR has a <a href="https://support.jstor.org/hc/en-us/articles/115004879547-JSTOR-s-Moving-Wall-Archive-vs-Current-Definitions">moving wall</a>, we should take a look at the number of articles per year in our dataset.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">research_articles <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(pub_year)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_bar</span>() </a></code></pre></div>
<p><img src="analysing-n-grams_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>From this graph we can see an increase in research articles until 2010, after which the number of articles first tapers off, and then drops off sharply. For this reason we should exclude articles at least from 2015 onward, since the sample might get quite biased toward specific journals.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">without_wall &lt;-<span class="st"> </span>research_articles <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(pub_year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2015</span>)</a></code></pre></div>
</div>
<div id="flagship-journals---filtering-articles-by-journal" class="section level2">
<h2 class="hasAnchor">
<a href="#flagship-journals---filtering-articles-by-journal" class="anchor"></a>Flagship journals - filtering articles by journal</h2>
<p>Since the amount of articles is still rather large for this demonstration, we could select only a few journals. Here, we will look at articles from two leading journals within the discipline, “American Journal of Sociology” and “American Sociological Review”.</p>
<p>Since we cleaned the identifiers for journals with <code>jst_augment</code> earlier, we can select our two flagship-journals very easily.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">flagship_journals &lt;-<span class="st"> </span>without_wall <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(journal_id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"amerjsoci"</span>, <span class="st">"amersocirevi"</span>))</a></code></pre></div>
</div>
</div>
<div id="importing-bigrams" class="section level1">
<h1 class="hasAnchor">
<a href="#importing-bigrams" class="anchor"></a>Importing bigrams</h1>
<blockquote>
<p>Disclaimer: Much of the following analysis was inspired by the book “Text Mining with R” by Julia Silge and David Robinson: <a href="https://www.tidytextmining.com" class="uri">https://www.tidytextmining.com</a></p>
</blockquote>
<p>For this demonstration we will look at bigrams to find the most common pairs of words. Until now, we were only dealing with the metadata, therefore we need a way to link our reduced dataset to the bigram files from DfR. The directory structure for deliveries from DfR looks something like this:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">receipt<span class="op">-</span>id<span class="dv">-123456</span><span class="op">-</span>part<span class="dv">-001</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">  <span class="op">--</span><span class="st"> </span>metadata</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">    <span class="op">--</span><span class="st"> </span>journal_article_foo.xml</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">       .</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">       .</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">       .</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">  <span class="op">--</span><span class="st"> </span>ngram2</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">    <span class="op">--</span><span class="st"> </span>journal_article_foo.txt</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">       .</a>
<a class="sourceLine" id="cb19-10" data-line-number="10">       .</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">       .</a>
<a class="sourceLine" id="cb19-12" data-line-number="12">receipt<span class="op">-</span>id<span class="dv">-123456</span><span class="op">-</span>part<span class="dv">-002</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">  <span class="op">--</span><span class="st"> </span>metadata</a>
<a class="sourceLine" id="cb19-14" data-line-number="14">    <span class="op">--</span><span class="st"> </span>journal_article_bar.xml</a>
<a class="sourceLine" id="cb19-15" data-line-number="15">       .</a>
<a class="sourceLine" id="cb19-16" data-line-number="16">       .</a>
<a class="sourceLine" id="cb19-17" data-line-number="17">       .</a>
<a class="sourceLine" id="cb19-18" data-line-number="18">  <span class="op">--</span><span class="st"> </span>ngram2</a>
<a class="sourceLine" id="cb19-19" data-line-number="19">    <span class="op">--</span><span class="st"> </span>journal_article_bar.txt</a>
<a class="sourceLine" id="cb19-20" data-line-number="20">       .</a>
<a class="sourceLine" id="cb19-21" data-line-number="21">       .</a>
<a class="sourceLine" id="cb19-22" data-line-number="22">       .</a></code></pre></div>
<p>From this structure we can see, that the file name can serve as an identifier to match articles and n-grams, since it is similar between metadata and n-grams.</p>
<p>To make importing a subset of ngrams more convenient, we can use <code>jst_subset_ngrams</code>. This function returns a list of “zip-locations”, which <code>jst_get_ngram</code> can read.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">ngram_selection &lt;-<span class="st"> </span><span class="kw"><a href="../reference/jst_subset_ngrams.html">jst_subset_ngrams</a></span>(<span class="kw">c</span>(<span class="st">"part1.zip"</span>, <span class="st">"part2.zip"</span>), <span class="st">"ngram2"</span>,</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">                                    flagship_journals)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">head</span>(ngram_selection, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [[1]]
## $zip_archive
## [1] part1.zip
## Levels: part1.zip part2.zip
## 
## $file_path
## [1] "ngram2/journal-article-10.1086_210001-ngram2.txt"
## 
## attr(,"class")
## [1] "jstor_zip"
## 
## [[2]]
## $zip_archive
## [1] part1.zip
## Levels: part1.zip part2.zip
## 
## $file_path
## [1] "ngram2/journal-article-10.1086_210004-ngram2.txt"
## 
## attr(,"class")
## [1] "jstor_zip"</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">ngram_selection &lt;-<span class="st"> </span><span class="kw"><a href="../reference/jst_subset_ngrams.html">jst_subset_ngrams</a></span>(<span class="kw">c</span>(<span class="st">"part1.zip"</span>, <span class="st">"part2.zip"</span>), <span class="st">"ngram2"</span>,</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">                                    flagship_journals)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">imported_bigrams &lt;-<span class="st"> </span>ngram_selection <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">  </span>furrr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/furrr/topics/future_map">future_map_dfr</a></span>(jst_get_ngram)</a></code></pre></div>
<p>From the 872 articles in our two flagship journals we now have 6,729,813 bigrams. The bigrams are calculated by JSTOR for each article independently. In order to reduce the sample to the most common bigrams, we have two choices: either to include only terms which occur <em>within each</em> article a given amount of times, or to include terms which occur <em>within all</em> articles a given amount of times. By only including terms which occur more than 5 times in each article, we can drastically reduce the number of terms. However, we might miss some important ones: there might be terms which do not occur repeatedly within articles, but are present in all of them.</p>
<p>For demonstration purposes we are a bit restrictive and include only those terms, which occur at least three times per article.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">top_bigrams &lt;-<span class="st"> </span>imported_bigrams <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>)</a></code></pre></div>
<div id="cleaning-up-bigrams" class="section level2">
<h2 class="hasAnchor">
<a href="#cleaning-up-bigrams" class="anchor"></a>Cleaning up bigrams</h2>
<p>When constructing n-grams, DfR uses a stop-word list, which is quite limited <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. If we would like to restrict the terms a bit further, we could use stopwords from <code>tidytext</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">library</span>(tidytext)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">bigrams_separated &lt;-<span class="st"> </span>top_bigrams <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw">separate</span>(bigrams, <span class="kw">c</span>(<span class="st">"word1"</span>, <span class="st">"word2"</span>), <span class="dt">sep =</span> <span class="st">" "</span>)</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"></a>
<a class="sourceLine" id="cb24-5" data-line-number="5">bigrams_filtered &lt;-<span class="st"> </span>bigrams_separated <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>word1 <span class="op">%in%</span><span class="st"> </span>stop_words<span class="op">$</span>word) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>word2 <span class="op">%in%</span><span class="st"> </span>stop_words<span class="op">$</span>word)</a></code></pre></div>
<p>After removing the stopwords we need to consider the fact, that our bigrams were created for each article on its own. In order to analyse them together, we need to count the terms for all articles in combination.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">bigram_counts &lt;-<span class="st"> </span>bigrams_filtered <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(word1, word2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">sum</span>(n)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))</a>
<a class="sourceLine" id="cb25-5" data-line-number="5"></a>
<a class="sourceLine" id="cb25-6" data-line-number="6">bigram_counts</a></code></pre></div>
<pre><code>## # A tibble: 106,706 x 3
## # Groups:   word1 [18,152]
##    word1        word2            n
##    &lt;chr&gt;        &lt;chr&gt;        &lt;int&gt;
##  1 american     sociological  9593
##  2 sociological review        9198
##  3 university   press         4603
##  4 labor        market        3555
##  5 american     journal       3273
##  6 9            7             3270
##  7 7            6             3260
##  8 10           9             3230
##  9 amsmath      amsxtra       3192
## 10 begin        document      3192
## # ... with 106,696 more rows</code></pre>
<p>From the first few terms we can see, that there are still many terms which are not very interesting for our analysis. The terms “american” and “sociological” are simply part of the title of a journal we selected (American Sociological Review). To clean the terms up, we can employ different approaches. One is to simply filter the terms we wish to exclude:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">bigram_counts_clean &lt;-<span class="st"> </span>bigram_counts <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="st">  </span><span class="kw">unite</span>(bigram, word1, word2, <span class="dt">sep =</span> <span class="st">" "</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>bigram <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"american sociological"</span>, <span class="st">"sociological review"</span>,</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">                        <span class="st">"university press"</span>, <span class="st">"american journal"</span>,</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">                        <span class="st">"journal sociology"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="st">  </span><span class="kw">separate</span>(bigram, <span class="kw">c</span>(<span class="st">"word1"</span>, <span class="st">"word2"</span>))</a></code></pre></div>
<p>We will look at another approach after plotting our bigrams.</p>
</div>
</div>
<div id="visualize-relationships" class="section level1">
<h1 class="hasAnchor">
<a href="#visualize-relationships" class="anchor"></a>Visualize relationships</h1>
<p>When analyzing bigrams, we might want to look at the relationships between common terms. For this we can leverage the power of <a href="http://igraph.org/r/">igraph</a> and <a href="https://cran.r-project.org/web/packages/ggraph/index.html">ggraph</a>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">library</span>(igraph)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="kw">library</span>(ggraph)</a></code></pre></div>
<p>First, we only keep the most common terms and then convert our <code>data.frame</code> to an <code>igraph</code>-object. <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">bigram_graph &lt;-<span class="st"> </span>bigram_counts_clean <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">500</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph_from_data_frame</a></span>()</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">bigram_graph</a></code></pre></div>
<pre><code>## IGRAPH da460da DN-- 170 161 -- 
## + attr: name (v/c), n (e/n)
## + edges from da460da (vertex names):
##  [1] labor                 -&gt;market   9                     -&gt;7       
##  [3] 7                     -&gt;6        10                    -&gt;9       
##  [5] amsmath               -&gt;amsxtra  begin                 -&gt;document
##  [7] declaremathsizes      -&gt;10       declaretextfontcommand-&gt;textcyr 
##  [9] documentclass         -&gt;aastex   encodingdefault       -&gt;ot2     
## [11] newcommand            -&gt;cyr      ot1                   -&gt;fontenc 
## [13] ot2                   -&gt;ot1      pagestyle             -&gt;empty   
## [15] portland              -&gt;xspace  
## + ... omitted several edges</code></pre>
<p>For plotting, we will use a simple plotting function, adapted from <a href="https://www.tidytextmining.com/ngrams.html#visualizing-a-network-of-bigrams-with-ggraph" class="uri">https://www.tidytextmining.com/ngrams.html#visualizing-a-network-of-bigrams-with-ggraph</a>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">plot_bigrams &lt;-<span class="st"> </span><span class="cf">function</span>(igraph_df, <span class="dt">seed =</span> <span class="dv">2016</span>) {</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">  <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb31-4" data-line-number="4">  a &lt;-<span class="st"> </span>grid<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/grid/topics/arrow">arrow</a></span>(<span class="dt">type =</span> <span class="st">"closed"</span>, <span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>, <span class="st">"inches"</span>))</a>
<a class="sourceLine" id="cb31-5" data-line-number="5"></a>
<a class="sourceLine" id="cb31-6" data-line-number="6">  <span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/ggraph">ggraph</a></span>(igraph_df, <span class="dt">layout =</span> <span class="st">"fr"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/geom_edge_link">geom_edge_link</a></span>(<span class="kw">aes</span>(<span class="dt">edge_alpha =</span> n), <span class="dt">show.legend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">                   <span class="dt">arrow =</span> a, <span class="dt">end_cap =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/geometry">circle</a></span>(.<span class="dv">07</span>, <span class="st">'inches'</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/geom_node_point">geom_node_point</a></span>(<span class="dt">color =</span> <span class="st">"lightblue"</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10"><span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/geom_node_text">geom_node_text</a></span>(<span class="kw">aes</span>(<span class="dt">label =</span> name), <span class="dt">repel =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/theme_graph">theme_graph</a></span>()</a>
<a class="sourceLine" id="cb31-12" data-line-number="12">}</a></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">plot_bigrams</span>(bigram_graph)</a></code></pre></div>
<p><img src="analysing-n-grams_files/figure-html/unnamed-chunk-24-1.png" width="1152"> Very obvious is a group of nodes which are not relevant to the topic of inequality. They come from LaTeX documents and somehow made their way into the original dataset. However, since they are more common than most of the other terms, they are quite easy to remove. We can look at the nodes/vertices of our graph with <code><a href="http://www.rdocumentation.org/packages/igraph/topics/V">V(bigram_graph)</a></code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="http://www.rdocumentation.org/packages/igraph/topics/V">V</a></span>(bigram_graph)</a></code></pre></div>
<pre><code>## + 170/170 vertices, named, from da460da:
##   [1] labor                  9                      7                     
##   [4] 10                     amsmath                begin                 
##   [7] declaremathsizes       declaretextfontcommand documentclass         
##  [10] encodingdefault        newcommand             ot1                   
##  [13] ot2                    pagestyle              portland              
##  [16] renewcommand           rmdefault              sfdefault             
##  [19] textcyr                usepackage             6                     
##  [22] aastex                 amsbsy                 amsfonts              
##  [25] amssymb                amsxtra                bm                    
##  [28] cyr                    document               empty                 
## + ... omitted several vertices</code></pre>
<p>The first node, “labor”, is relevant to us, but all other nodes from 2 to at least 40 are clearly irrelevant. We can remove them by simple subtraction:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">bigram_graph_clean &lt;-<span class="st"> </span>bigram_graph <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">40</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2">bigram_graph_clean</a></code></pre></div>
<pre><code>## IGRAPH 183104b DN-- 131 105 -- 
## + attr: name (v/c), n (e/n)
## + edges from 183104b (vertex names):
##  [1] labor     -&gt;market     labor     -&gt;force      0         -&gt;0         
##  [4] table     -&gt;2          1         -&gt;1          income    -&gt;inequality
##  [7] black     -&gt;white      table     -&gt;1          table     -&gt;3         
## [10] social    -&gt;capital    model     -&gt;1          model     -&gt;2         
## [13] african   -&gt;american   0         -&gt;1          human     -&gt;capital   
## [16] african   -&gt;americans  table     -&gt;4          1         -&gt;2         
## [19] model     -&gt;3          racial    -&gt;ethnic     individual-&gt;level     
## [22] civil     -&gt;rights     cross     -&gt;national  
## + ... omitted several edges</code></pre>
<p>Another apparent group is a combination of “table” or “figure” with digits. This evidently comes from tables or figures in the papers and might suggest, that the articles in our sample quite frequently employ quantitative methods, where figures and tables are very common. For the analysis at hand however, we might remove them, along with a few other irrelevant terms.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">bigram_graph_clean &lt;-<span class="st"> </span>bigram_graph_clean <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"table"</span>, <span class="st">"model"</span>,</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">                                             <span class="kw">as.character</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">                                             <span class="st">"xd"</span>, <span class="st">"rh"</span>, <span class="st">"landscape"</span>, <span class="st">"00"</span>,</a>
<a class="sourceLine" id="cb37-4" data-line-number="4">                                             <span class="st">"figure"</span>, <span class="st">"review"</span>, <span class="st">"79"</span>,</a>
<a class="sourceLine" id="cb37-5" data-line-number="5">                                             <span class="st">"http"</span>, <span class="st">"www"</span>, <span class="st">"000"</span>, <span class="st">"01"</span>)</a></code></pre></div>
<p>After cleaning up a bit, we can take a fresh look at our bigrams.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">plot_bigrams</span>(bigram_graph_clean, <span class="dv">234</span>)</a></code></pre></div>
<p><img src="analysing-n-grams_files/figure-html/unnamed-chunk-28-1.png" width="1152"></p>
<p>The figure is still far from perfect (“eco” -&gt; “nomic” should clearly be one term), but we can begin to analyse our network.</p>
<p>The most frequent bigrams are now “labor market”, “labor force”, and “income inequality”, which are not very surprising given that most individuals in capitalist societies need to supply their work in exchange for income. For this reason, the labor market and its stratification is a prime subject of the sociological inquiry into inequality. A few further key dimensions of sociological analysis are apparent from the graph: gender, race/ethnicity, occupational and socioeconomic status. That we find many terms to be associated with the term “social” seems quite likely given the discipline’s subject.</p>
<p>At least two surprising results should be pointed out. First, it is not evident how the terms “ethnic” and “racial” are connected. They do not form a typical term like “social capital”, “middle class” or similar, nor could they be considered a dichotomy like “black” and “white” which are often included in tables from regressions. From a theoretical point of view, they have slightly different meanings but are frequently being used as synonyms. Second, there is a group of nodes around the term “university”: university -&gt; chicago, university -&gt; california, harvard -&gt; university, etc. At least two explanations seem plausible: either, many books are being cited which are in some way associated with those universities (“The University of Chicago Press” is the largest university press in the United States), or many researchers who publish in the two flagship-journals we selected are affiliated with those four universities: Harvard, Chicago, Cambridge and California. At least partly the prominence of university -&gt; chicago -&gt; press might be due to the fact, that it is the publisher of the American Journal of Sociology, and therefore included in each article by this journal.</p>
<p>Altogether, these findings will not be surprising to well-educated sociologists. Almost all bigrams in the graph are common concepts or terms within the discipline. Most importantly, very often those concepts and terms comprise two single words, as in “social science”, “social structure”, “social networks”. Two approaches might be useful to examine, <em>how</em> these concepts are being used:</p>
<ol style="list-style-type: decimal">
<li>Analyzing trigrams. It could be the case, that many of the above concepts would show up in combination with more interesting terms, if we were to analyze combinations of three words.</li>
<li>Another approach would be to first analyze data for bigrams as above, determining the core concepts of a field. In a second step, one could search for those core concepts in the raw data files and extract adjacent terms. This would not be possible with the default deliveries from DfR however, since full-text content is only available through a dedicated agreement.</li>
</ol>
</div>
<div id="comparison-over-time" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-over-time" class="anchor"></a>Comparison over time</h1>
<p>Besides looking at the overall relationship of bigrams, we could be interested in the development over time of specific terms. Here, we want to look at how often “labor market” and “income inequality” appear from year to year.</p>
<p>For this, we need to join our bigrams with the metadata.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">time_bigrams &lt;-<span class="st"> </span>top_bigrams <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(flagship_journals, <span class="dt">by =</span> <span class="st">"file_name"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(bigrams, n, pub_year)</a>
<a class="sourceLine" id="cb39-4" data-line-number="4"></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="kw">head</span>(time_bigrams)</a></code></pre></div>
<pre><code>##             bigrams  n pub_year
## 1    private sector 92     1998
## 2 market transition 68     1998
## 3               3 t 38     1998
## 4              1 00 37     1998
## 5 journal sociology 34     1998
## 6      state sector 34     1998</code></pre>
<p>Again, we need to sum up the counts, but this time grouped by year:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">time_bigrams &lt;-<span class="st"> </span>time_bigrams <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(bigrams, pub_year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">sum</span>(n)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))</a>
<a class="sourceLine" id="cb41-5" data-line-number="5"></a>
<a class="sourceLine" id="cb41-6" data-line-number="6">time_bigrams</a></code></pre></div>
<pre><code>## # A tibble: 248,725 x 3
## # Groups:   bigrams [157,266]
##    bigrams               pub_year     n
##    &lt;chr&gt;                    &lt;int&gt; &lt;int&gt;
##  1 0 0                       2004  1071
##  2 et al                     2014   916
##  3 women s                   2006   885
##  4 american sociological     2014   860
##  5 sociological review       2014   814
##  6 u s                       2014   793
##  7 et al                     2011   792
##  8 et al                     2013   748
##  9 et al                     2010   691
## 10 et al                     2012   687
## # ... with 248,715 more rows</code></pre>
<p>We now only keep the two terms of interest and plot them in a simple chart.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># filter the terms of interest</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2">time_comparison &lt;-<span class="st"> </span>time_bigrams <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(bigrams <span class="op">==</span><span class="st"> "labor market"</span> <span class="op">|</span><span class="st"> </span>bigrams <span class="op">==</span><span class="st"> "income inequality"</span>)</a>
<a class="sourceLine" id="cb43-4" data-line-number="4"></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="kw">ggplot</span>(time_comparison, <span class="kw">aes</span>(pub_year, n, <span class="dt">colour =</span> bigrams)) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb43-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> scales<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/scales/topics/pretty_breaks">pretty_breaks</a></span>(<span class="dv">7</span>))</a></code></pre></div>
<p><img src="analysing-n-grams_files/figure-html/unnamed-chunk-31-1.png" width="960"></p>
<p>In this instance, the plot does not reveal trends over time-the frequency of the terms is fluctuating a lot but staying on a similar level. Single spikes of term frequency for specific years (for example income inequality in 2011) could stem from special issues being explicitly concerned with income inequality, although a quick glance at the corresponding issues invalidates this hypothesis.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>An introduction on how to create datasets can be found on the page of DfR: <a href="http://www.jstor.org/dfr/about/creating-datasets" class="uri">http://www.jstor.org/dfr/about/creating-datasets</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>for more information see the <a href="http://www.jstor.org/dfr/about/technical-specifications">technical specifications</a> on their page<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>If you are unfamiliar with graph theory, just take a look at Wikipedia: <a href="https://en.wikipedia.org/wiki/Graph_theory">Graph Theory</a>.<a href="#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#cleaning-the-data">Cleaning the data</a></li>
      <li>
<a href="#exploration">Exploration</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-moving-wall---filtering-articles-by-time">The moving wall - filtering articles by time</a></li>
      <li><a href="#flagship-journals---filtering-articles-by-journal">Flagship journals - filtering articles by journal</a></li>
      </ul>
</li>
      <li>
<a href="#importing-bigrams">Importing bigrams</a><ul class="nav nav-pills nav-stacked">
<li><a href="#cleaning-up-bigrams">Cleaning up bigrams</a></li>
      </ul>
</li>
      <li><a href="#visualize-relationships">Visualize relationships</a></li>
      <li><a href="#comparison-over-time">Comparison over time</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://thomasklebel.eu">Thomas Klebel</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
